---
title: "Optimization: EM and MM Algorithms"
format:
  html:
    toc: true
    toc-location: right
execute:
  echo: false
  fig-width: 6
  fig-asp: 0.6
  out-width: "90%"
---



## Overview

In this, we will focus on the EM and MM algorithms.


::: {.panel-tabset .panel-pills}

### Slide Deck: Introduction to the Expectation-Maximization (EM) Algorithm

[![](./slides/topic_optimization/preview_EM.png){width=70%}](./slides/topic_optimization/s_EM.pdf)

**Intro EM**  
[Download slides (PDF)](./slides/topic_optimization/s_EM.pdf)


***

### Slide Deck: EM Theory

[![](./slides/topic_optimization/preview_EM_theory.png){width=70%}](./slides/topic_optimization/s_EM_theory.pdf)

**EM Theory**  
[Download slides (PDF)](./slides/topic_optimization/s_EM_theory.pdf)


***


### Slide Deck: MM


***

### Lab: Introduction to EM


#### Exercise 1: Two-component Gaussian mixture model

This will use the example given in Lecture for the two component GMM.  Your role will be to modify the code `EM_GMM.R`.  


In this code, we are implementing a two component Gaussian mixture model to fit to the Old Faithful Geyser dataset.  This dataset provides the waiting time between eruptions for Old Faithul in Yellowstone National Park.  Notice that the waiting times between eruptions have a bimodal distribution:


```{r}
data(faithful)
hist(faithful$waiting)
```


We will use a GMM to find the mean and variance of the two modes (assumption a Gaussian distribution or each mode), and assign a probability that each waiting time belongs to each mode.  


Open the code `EM_GMM.R` and do the following:


- Complete the E-step of the EM algorithm (M-step is already complete)
- Add in tolerance criteria to the `while` loop
  - What likelihood should we be monitoring for convergence?
  - Plot this likelihood at each iteration.  Is it monotonic?

- Once your code is complete, try out different initialization parameters. Do you get to the same answer? 



#### Exercise 2: Censored exponential data


Suppose we have survival times $t_1, \ldots, t_n \sim Exponential(\lambda)$. 

* Do not observe all survival times because some are censored at times $c_1, \ldots, c_n$.  
* Actually observe $y_1, \ldots, y_n$, where $y_i = min(y_0, c_i)$
  * Also have an indicator $\delta_i$ where $\delta_i = 1$ is $y_i \le c_i$
    * i.e. $\delta_i = 1$ if not censored and $\delta_i = 0$ if censored

<br>

* What is $p(y, z |\theta)$, the complete data density?


* What is $z$?

* Set up the function $Q(\lambda|\lambda_0)$

:::
